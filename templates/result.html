<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Your Plan — NutreGen AI</title>
  <style>
    body{font-family:Arial, sans-serif; background:#f6fff8; padding:24px}
    .card{max-width:800px; margin:0 auto; background:#fff; padding:20px; border-radius:12px; box-shadow:0 8px 30px rgba(0,0,0,.06)}
    .grid{display:grid; grid-template-columns:1fr 1fr; gap:12px}
    .pill{display:inline-block; background:#eef8f0; border:1px solid #dcefe0; padding:6px 10px; border-radius:999px; margin:4px 6px 0 0}
    table{width:100%; border-collapse:collapse; margin-top:10px}
    td,th{border:1px solid #e6efe8; padding:10px; text-align:left}
  </style>
</head>
<body>
  <div class="card">
    <h1>Your personalised plan</h1>
    <p><strong>Name:</strong> {{ name }}<br>
       <strong>Email:</strong> {{ email }}</p>

    <div class="grid">
      <div>
        <p><strong>Activity:</strong> {{ activity }}</p>
        <p><strong>Genetic traits:</strong>
          {% if traits and traits|length %}
            {% for t in traits %}<span class="pill">{{ t }}</span>{% endfor %}
          {% else %} None provided
          {% endif %}
        </p>
        <p><strong>DNA file:</strong> {{ dna_summary }}</p>
      </div>
      <div>
        <p><strong>Target calories:</strong> {{ calories }} kcal/day</p>
        <p><strong>Macros:</strong><br>
          Carbs: {{ macros.carbs }}%<br>
          Fats: {{ macros.fats }}%<br>
          Protein: {{ macros.protein }}%</p>
      </div>
    </div>

    <h2>Meal ideas</h2>
    <table>
      <tr><th>Meal</th><th>Idea</th><th>Notes</th></tr>
      {% for m in plan %}
        <tr><td>{{ m.meal }}</td><td>{{ m.idea }}</td><td>{{ m.notes }}</td></tr>
      {% endfor %}
    </table>

    <p style="margin-top:16px;">
      <a href="/form">← Create another plan</a>
    </p>
    <hr style="margin: 16px 0;">

<form action="/download-pdf" method="POST">
  <!-- Required fields -->
  <input type="hidden" name="name" value="{{ name }}">
  <input type="hidden" name="email" value="{{ email }}">
  <input type="hidden" name="activity" value="{{ activity }}">
  <input type="hidden" name="calories" value="{{ calories }}">
  <input type="hidden" name="macros_carbs" value="{{ macros.carbs }}">
  <input type="hidden" name="macros_fats" value="{{ macros.fats }}">
  <input type="hidden" name="macros_protein" value="{{ macros.protein }}">

  <!-- Traits (multiple) -->
  {% if traits %}
    {% for t in traits %}
      <input type="hidden" name="traits" value="{{ t }}">
    {% endfor %}
  {% endif %}

  <!-- Meal plan as JSON -->
  <input type="hidden" name="plan_json" value='{{ plan|tojson }}'>

  <!-- DNA summary text -->
  <input type="hidden" name="dna_summary" value="{{ dna_summary }}">

  <button type="submit" style="
    width: 100%; padding: 12px 16px; border: none; border-radius: 10px;
    background: #2e7d32; color: #fff; font-weight: 700; cursor: pointer;">
    Download PDF
  </button>
</form>

  </div>
</body>
</html>
